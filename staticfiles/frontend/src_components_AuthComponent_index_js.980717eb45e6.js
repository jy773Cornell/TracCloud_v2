/*! For license information please see src_components_AuthComponent_index_js.js.LICENSE.txt */
"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([["src_components_AuthComponent_index_js"],{"./src/components/AuthComponent/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "default": () => (/* binding */ AuthComponent)\n/* harmony export */ });\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react-router-dom */ "./node_modules/react-router/dist/index.js");\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils */ "./src/utils/index.js");\n\n\n\n\nconst Loading = /*#__PURE__*/(0,react__WEBPACK_IMPORTED_MODULE_0__.lazy)(() => Promise.all(/*! import() */[__webpack_require__.e("vendors-node_modules_mui_material_styles_styled_js-node_modules_mui_material_styles_useTheme_-527862"), __webpack_require__.e("vendors-node_modules_mui_system_esm_createStyled_js"), __webpack_require__.e("vendors-node_modules_mui_material_Grid_Grid_js"), __webpack_require__.e("src_components_Loading_index_js-_d1da0")]).then(__webpack_require__.bind(__webpack_require__, /*! ../Loading */ "./src/components/Loading/index.js")));\nconst Layout = /*#__PURE__*/(0,react__WEBPACK_IMPORTED_MODULE_0__.lazy)(() => Promise.all(/*! import() */[__webpack_require__.e("vendors-node_modules_mui_system_esm_createStyled_js"), __webpack_require__.e("src_components_Layout_index_js")]).then(__webpack_require__.bind(__webpack_require__, /*! ../Layout */ "./src/components/Layout/index.js")));\nfunction AuthComponent({\n  uid,\n  setUID,\n  setEmployerID,\n  setPrivilege\n}) {\n  const [authStatus, setAuthStatus] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)("loading");\n  async function AuthCheck() {\n    const csrftoken = (0,_utils__WEBPACK_IMPORTED_MODULE_1__.getCookie)(\'csrftoken\');\n    const requestOptions = {\n      method: "POST",\n      headers: {\n        "Content-Type": "application/json",\n        \'X-CSRFToken\': csrftoken\n      },\n      body: JSON.stringify({\n        token: (0,_utils__WEBPACK_IMPORTED_MODULE_1__.getToken)()\n      })\n    };\n    await fetch("/api/auth/", requestOptions).then(async response => {\n      if (response.ok) {\n        response.json().then(async data => {\n          setUID(data.uid);\n          if (data.type === "Admin") {\n            window.location.href = \'admin\';\n          } else {\n            await Promise.all([EmployerIDGet(data.uid), PrivilegeGet(data.uid)]);\n            setAuthStatus("authorized");\n          }\n        });\n      } else {\n        setAuthStatus("unauthorized");\n      }\n    });\n  }\n  async function EmployerIDGet(uid) {\n    const requestOptions = {\n      method: "GET",\n      headers: {\n        "Content-Type": "application/json"\n      }\n    };\n    await fetch("/user_manage/employer/get/?uid=" + uid, requestOptions).then(response => {\n      if (response.ok) {\n        response.json().then(data => {\n          setEmployerID(data.employer_id);\n        });\n      }\n    });\n  }\n  async function PrivilegeGet(uid) {\n    const requestOptions = {\n      method: "GET",\n      headers: {\n        "Content-Type": "application/json"\n      }\n    };\n    await fetch("/user_manage/privilege/get/?uid=" + uid, requestOptions).then(response => {\n      if (response.ok) {\n        response.json().then(data => {\n          setPrivilege(data.data);\n        });\n      }\n    });\n  }\n  (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {\n    AuthCheck();\n  }, []);\n  if (authStatus === "loading") {\n    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(Loading, null);\n  } else if (authStatus === "authorized") {\n    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(Layout, {\n      uid: uid\n    });\n  } else if (authStatus === "unauthorized") {\n    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_2__.Navigate, {\n      to: "/login",\n      replace: true\n    });\n  }\n}\n\n//# sourceURL=webpack://frontend/./src/components/AuthComponent/index.js?')}}]);