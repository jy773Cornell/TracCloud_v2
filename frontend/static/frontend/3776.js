"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[3776],{7600:(e,t,n)=>{n.r(t),n.d(t,{default:()=>o});var a=n(1504),l=n(6988),r=n(6350),i=n(4408);function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},s.apply(this,arguments)}const c=a.forwardRef((function(e,t){return a.createElement(i.c,s({elevation:6,ref:t,variant:"filled"},e))}));function o(e){const t=(t,n)=>{"clickaway"!==n&&e.setOpen(!1)};return a.createElement(l.c,{spacing:2,sx:{width:"100%"}},a.createElement(r.c,{open:e.open,autoHideDuration:6e3,onClose:t},(()=>{switch(e.tag){case"success":return a.createElement(c,{onClose:t,severity:"success",sx:{width:"100%"}},e.msg);case"error":return a.createElement(c,{onClose:t,severity:"error",sx:{width:"100%"}},e.msg);case"warning":return a.createElement(c,{onClose:t,severity:"warning",sx:{width:"100%"}},e.msg);default:return null}})()))}},3776:(e,t,n)=>{n.r(t),n.d(t,{default:()=>I});var a=n(1504),l=n(7600),r=n(2528),i=n(9644),s=n(3964),c=n(3604),o=n(4477),u=n(1940),d=n(6060),p=n(3628);const m=(0,d.c)(u.c)((()=>({backgroundColor:p.c[500],"&:hover":{backgroundColor:p.c[700]}})));var v=n(7500),h=n(768),E=n(2264),b=n.n(E),x=n(3144),y=n(6968);function f({relationType:e,privilege:t,field_names:n,profile:l,fieldValues:r,isEdit:i,setIsEdit:d,inputError:p,onEditClicked:E,handleInputChange:f,handleSaveButtonPressed:C}){return a.createElement(y.c,{sx:{width:800,border:"1px solid #c8c8c8"}},a.createElement(o.c,null,a.createElement(s.cp,{container:!0,justifyContent:"center",spacing:2},a.createElement(a.Fragment,null,a.createElement(s.cp,{item:!0,xs:12,sx:{textAlign:"center"}},a.createElement("h1",null,l.username)),a.createElement(s.cp,{item:!0,xs:4},a.createElement(c.c,{label:"Type",variant:"outlined",value:l[n[0]],InputProps:{readOnly:!0},sx:{width:"100%"}})),a.createElement(s.cp,{item:!0,xs:4},i?a.createElement(c.c,{label:"First Name",variant:"outlined",required:!0,value:r[n[1]],error:p[n[1]],autoComplete:"given-name",onChange:e=>{f(e,e.target.value,n[1])},InputLabelProps:{shrink:!0},sx:{width:"100%"}}):a.createElement(c.c,{label:"First Name",variant:"outlined",value:l[n[1]],InputProps:{readOnly:!0},sx:{width:"100%"}})),a.createElement(s.cp,{item:!0,xs:4},i?a.createElement(c.c,{label:"Last Name",variant:"outlined",required:!0,value:r[n[2]],error:p[n[2]],autoComplete:"family-name",onChange:e=>{f(e,e.target.value,n[2])},InputLabelProps:{shrink:!0},sx:{width:"100%"}}):a.createElement(c.c,{label:"Last Name",variant:"outlined",value:l[n[2]],InputProps:{readOnly:!0},sx:{width:"100%"}})),a.createElement(a.Fragment,null,a.createElement(s.cp,{item:!0,xs:12},i&&t.business_u?a.createElement(c.c,{label:"Business Name",variant:"outlined",required:!0,value:r[n[5]],error:p[n[5]],onChange:e=>{f(e,e.target.value,n[5])},InputLabelProps:{shrink:!0},sx:{width:"100%"}}):a.createElement(c.c,{label:"Business Name",variant:"outlined",value:l[n[5]],InputProps:{readOnly:!0},sx:{width:"100%"}})),a.createElement(s.cp,{item:!0,xs:12},i&&t.business_u?a.createElement(c.c,{label:"Address Line1",variant:"outlined",required:!0,autoComplete:"address-line1",value:r[n[6]],error:p[n[6]],onChange:e=>{f(e,e.target.value,n[6])},InputLabelProps:{shrink:!0},sx:{width:"100%"}}):a.createElement(c.c,{label:"Address Line1",variant:"outlined",value:l[n[6]],InputProps:{readOnly:!0},sx:{width:"100%"}})),a.createElement(s.cp,{item:!0,xs:12},i&&t.business_u?a.createElement(c.c,{label:"Address Line2",variant:"outlined",autoComplete:"address-line2",value:r[n[7]],onChange:e=>{f(e,e.target.value,n[7])},InputLabelProps:{shrink:!0},sx:{width:"100%"}}):a.createElement(c.c,{label:"Address Line2",variant:"outlined",value:l[n[7]],InputProps:{readOnly:!0},sx:{width:"100%"}})),a.createElement(s.cp,{item:!0,xs:2.4},i&&t.business_u?a.createElement(c.c,{label:"City",variant:"outlined",value:r[n[8]],autoComplete:"address-level2",onChange:e=>{f(e,e.target.value,n[8])},InputLabelProps:{shrink:!0},sx:{width:"100%"}}):a.createElement(c.c,{label:"City",variant:"outlined",value:l[n[8]],InputProps:{readOnly:!0},sx:{width:"100%"}})),a.createElement(s.cp,{item:!0,xs:2.4},i&&t.business_u?a.createElement(c.c,{label:"State",variant:"outlined",value:r[n[9]],autoComplete:"address-level1",onChange:e=>{f(e,e.target.value,n[9])},InputLabelProps:{shrink:!0},sx:{width:"100%"}}):a.createElement(c.c,{label:"State",variant:"outlined",value:l[n[9]],InputProps:{readOnly:!0},sx:{width:"100%"}})),a.createElement(s.cp,{item:!0,xs:2.4},i&&t.business_u?a.createElement(c.c,{label:"Zip Code",variant:"outlined",value:r[n[10]],autoComplete:"postal-code",onChange:e=>{f(e,e.target.value,n[10])},InputLabelProps:{shrink:!0},sx:{width:"100%"}}):a.createElement(c.c,{label:"Zip Code",variant:"outlined",value:l[n[10]],InputProps:{readOnly:!0},sx:{width:"100%"}})),a.createElement(s.cp,{item:!0,xs:2.4},i&&t.business_u?a.createElement(c.c,{label:"County",variant:"outlined",value:r[n[11]],autoComplete:"address-level3",onChange:e=>{f(e,e.target.value,n[11])},InputLabelProps:{shrink:!0},sx:{width:"100%"}}):a.createElement(c.c,{label:"County",variant:"outlined",value:l[n[11]],InputProps:{readOnly:!0},sx:{width:"100%"}})),a.createElement(s.cp,{item:!0,xs:2.4},i&&t.business_u?a.createElement(c.c,{label:"Country",variant:"outlined",value:r[n[12]],autoComplete:"country",onChange:e=>{f(e,e.target.value,n[12])},InputLabelProps:{shrink:!0},sx:{width:"100%"}}):a.createElement(c.c,{label:"Country",variant:"outlined",value:l[n[12]],InputProps:{readOnly:!0},sx:{width:"100%"}}))),a.createElement(s.cp,{item:!0,xs:6},i?a.createElement(c.c,{label:"Cell Phone",variant:"outlined",value:r[n[13]],autoComplete:"tel",onChange:e=>{f(e,e.target.value,n[13])},InputLabelProps:{shrink:!0},sx:{width:"100%"}}):a.createElement(c.c,{label:"Cell Phones",variant:"outlined",value:l[n[13]],InputProps:{readOnly:!0},sx:{width:"100%"}})),a.createElement(s.cp,{item:!0,xs:6},i?a.createElement(c.c,{label:"Email",variant:"outlined",required:!0,value:r[n[14]],error:p[n[14]],autoComplete:"email",onChange:e=>{f(e,e.target.value,n[14])},InputLabelProps:{shrink:!0},sx:{width:"100%"}}):a.createElement(c.c,{label:"Email",variant:"outlined",value:l[n[14]],InputProps:{readOnly:!0},sx:{width:"100%"}}))),["Owner","Employee"].includes(e)&&a.createElement(a.Fragment,null,a.createElement(s.cp,{item:!0,xs:6},i?a.createElement(c.c,{label:"Pesticide Certification I.D. Number",variant:"outlined",value:r[n[3]],onChange:e=>{f(e,e.target.value,n[3])},InputLabelProps:{shrink:!0},sx:{width:"100%"}}):a.createElement(c.c,{label:"Pesticide Certification I.D. Number",variant:"outlined",value:l[n[3]],InputProps:{readOnly:!0},sx:{width:"100%"}})),a.createElement(s.cp,{item:!0,xs:6},i?a.createElement(x.c,{dateAdapter:v.q},a.createElement(h.I,{label:"Pesticide Certification Expire Date",variant:"outlined",required:!0,value:b()(r[n[4]]),onChange:e=>{f(e,b()(e).format("YYYY-MM-DD"),n[4])},sx:{width:"100%"}})):a.createElement(c.c,{label:"Pesticide Certification Expire Date",variant:"outlined",value:l[n[4]],InputProps:{readOnly:!0},sx:{width:"100%"}}))),i?a.createElement(a.Fragment,null,a.createElement(s.cp,{item:!0,xs:6,sx:{justifyContent:"center",textAlign:"center"}},a.createElement(u.c,{variant:"contained",color:"secondary",onClick:()=>d(!1)},"Cancel")),a.createElement(s.cp,{item:!0,xs:6,sx:{justifyContent:"center",textAlign:"center"}},a.createElement(u.c,{variant:"contained",color:"success",onClick:()=>C()},"Save"))):a.createElement(s.cp,{item:!0,xs:12,sx:{justifyContent:"center",textAlign:"center"}},a.createElement(m,{variant:"contained",color:"secondary",onClick:()=>E()},"Edit")))))}var C=n(3568);const g=(0,a.lazy)((()=>n.e(3912).then(n.bind(n,8676)))),w=["type","first_name","last_name","pesticide_applicator_no","pesticide_expire_date","business_name","address_line1","address_line2","city","state","zipcode","county","country","cell_phone","email","relation_type"],P=[w[5],w[6],w[7],w[8],w[9],w[10],w[11],w[12]];function I(e){const t=e.uid,n=e.employerID,s=e.privilege,c=e.relationType,[o,u]=(0,a.useState)([]),[d,p]=(0,a.useState)({}),[m,v]=(0,a.useState)({}),[h,E]=(0,a.useState)(!1),[b,x]=(0,a.useState)(!0),[y,I]=(0,a.useState)(!1),[k,O]=(0,a.useState)(!1),[_,L]=(0,a.useState)([]),[j,S]=(0,a.useState)(!1);async function A(e){const t=await fetch("/api/user/get/?uid="+e,{method:"GET",headers:{"Content-Type":"application/json"}});if(t.ok){const e=await t.json();return Object.fromEntries(Object.entries(e.data).map((([e,t])=>[e,null===t?"":t])))}throw new Error("Failed to fetch profile")}async function D(e,t){const[n,a]=await Promise.all([A(e),A(t)]);P.forEach((e=>{a.hasOwnProperty(e)&&(n[e]=a[e])})),u(n),v(n),x(!1)}async function N(e){console.log(e);const t={method:"PUT",headers:{"Content-Type":"application/json","X-CSRFToken":(0,r.U$)("csrftoken")},body:JSON.stringify(e)};await fetch("/api/user/profile/update/",t).then((e=>{e.ok&&(O(!0),S(~j))}))}const T=()=>{L(Object.fromEntries(w.map((e=>[e,!1]))))},F={relationType:c,privilege:s,field_names:w,profile:o,fieldValues:m,isEdit:y,setIsEdit:I,inputError:_,onEditClicked:()=>{p({}),v(Object.fromEntries(w.map((e=>[e,o[e]])))),I(!0),T()},handleInputChange:(e,t,n)=>{v({...m,[n]:t}),p({...d,[n]:t})},handleSaveButtonPressed:()=>{[m[w[1]],m[w[2]],m[w[5]],m[w[6]],m[w[14]]].every((e=>e))?(async function(){const e=(0,C.pick)(d,P);e.uid=n,await N(e);const a=(0,C.omit)(d,P);Object.keys(a).length>0&&(a.uid=t,await N(a))}(),I(!1)):Object.keys(m).forEach((e=>{""===m[e]?L((t=>({...t,[e]:!0}))):L((t=>({...t,[e]:!1})))}))}},q={open:k,setOpen:O,msg:"Profile is uploaded successfully!",tag:"success"};return(0,a.useEffect)((()=>{(async()=>{await Promise.all([D(t,n)])})(),T(),E(!0)}),[]),(0,a.useEffect)((()=>{h&&D(t,n)}),[j]),a.createElement(i.c,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100vh",p:2}},b?a.createElement(g,null):a.createElement(f,F),a.createElement(l.default,q))}}}]);