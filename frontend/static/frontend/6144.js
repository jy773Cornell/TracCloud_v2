"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[6144],{9700:(e,t,a)=>{var n=a(7649);t.c=void 0;var r=n(a(3540)),o=a(7624),c=(0,r.default)((0,o.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete");t.c=c},7516:(e,t,a)=>{a.d(t,{c:()=>b});var n=a(5072),r=a(5656),o=a(1504),c=a(3268),i=a.n(c),l=a(4971),s=a(4048),d=a(5664),p=a(6940),u=a(440),m=a(6968),h=a(7100),f=a(1272);function y(e){return(0,f.c)("MuiCard",e)}(0,h.c)("MuiCard",["root"]);var g=a(7624);const v=["className","raised"],E=(0,p.cp)(m.c,{name:"MuiCard",slot:"Root",overridesResolver:(e,t)=>t.root})((()=>({overflow:"hidden"}))),C=o.forwardRef((function(e,t){const a=(0,u.c)({props:e,name:"MuiCard"}),{className:o,raised:c=!1}=a,i=(0,r.c)(a,v),s=(0,n.c)({},a,{raised:c}),p=(e=>{const{classes:t}=e;return(0,d.c)({root:["root"]},y,t)})(s);return(0,g.jsx)(E,(0,n.c)({className:(0,l.c)(p.root,o),elevation:c?8:void 0,ref:t,ownerState:s},i))}));C.propTypes={children:i().node,classes:i().object,className:i().string,raised:(0,s.c)(i().bool,(e=>e.raised&&"outlined"===e.variant?new Error('MUI: Combining `raised={true}` with `variant="outlined"` has no effect.'):null)),sx:i().oneOfType([i().arrayOf(i().oneOfType([i().func,i().object,i().bool])),i().func,i().object])};const b=C},4477:(e,t,a)=>{a.d(t,{c:()=>E});var n=a(5072),r=a(5656),o=a(1504),c=a(3268),i=a.n(c),l=a(4971),s=a(5664),d=a(6940),p=a(440),u=a(7100),m=a(1272);function h(e){return(0,m.c)("MuiCardContent",e)}(0,u.c)("MuiCardContent",["root"]);var f=a(7624);const y=["className","component"],g=(0,d.cp)("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,t)=>t.root})((()=>({padding:16,"&:last-child":{paddingBottom:24}}))),v=o.forwardRef((function(e,t){const a=(0,p.c)({props:e,name:"MuiCardContent"}),{className:o,component:c="div"}=a,i=(0,r.c)(a,y),d=(0,n.c)({},a,{component:c}),u=(e=>{const{classes:t}=e;return(0,s.c)({root:["root"]},h,t)})(d);return(0,f.jsx)(g,(0,n.c)({as:c,className:(0,l.c)(u.root,o),ownerState:d,ref:t},i))}));v.propTypes={children:i().node,classes:i().object,className:i().string,component:i().elementType,sx:i().oneOfType([i().arrayOf(i().oneOfType([i().func,i().object,i().bool])),i().func,i().object])};const E=v},2060:(e,t,a)=>{a.d(t,{c:()=>l});var n=a(1504),r=a(1940),o=a(6864),c=a(8857),i=a(6968);function l(e){return n.createElement(o.cp,{open:Boolean(e.anchorEl),anchorEl:e.anchorEl,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},n.createElement(i.c,{sx:{p:1,maxWidth:400}},n.createElement(c.c,{variant:"body1"},e.msg),n.createElement(r.c,{onClick:()=>{"delete"===e.type?(e.setAnchorEl(null),e.onDeleteClicked(e.params)):"update"===e.type&&(e.setAnchorEl(null),e.onSaveClicked())},color:"primary"},"Yes"),n.createElement(r.c,{onClick:()=>e.setAnchorEl(null),color:"secondary"},"No")))}},7600:(e,t,a)=>{a.r(t),a.d(t,{default:()=>s});var n=a(1504),r=a(6988),o=a(6350),c=a(4408);function i(){return i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},i.apply(this,arguments)}const l=n.forwardRef((function(e,t){return n.createElement(c.c,i({elevation:6,ref:t,variant:"filled"},e))}));function s(e){const t=(t,a)=>{"clickaway"!==a&&e.setOpen(!1)};return n.createElement(r.c,{spacing:2,sx:{width:"100%"}},n.createElement(o.c,{open:e.open,autoHideDuration:6e3,onClose:t},(()=>{switch(e.tag){case"success":return n.createElement(l,{onClose:t,severity:"success",sx:{width:"100%"}},e.msg);case"error":return n.createElement(l,{onClose:t,severity:"error",sx:{width:"100%"}},e.msg);case"warning":return n.createElement(l,{onClose:t,severity:"warning",sx:{width:"100%"}},e.msg);default:return null}})()))}},6144:(e,t,a)=>{a.r(t),a.d(t,{default:()=>U});var n=a(1504),r=a(6968),o=a(3562),c=a(3704),i=a(3683),l=a(9700),s=a(108),d=a(8880),p=a(5984),u=a(7516),m=a(4477),h=a(3964),f=a(4660),y=a(3604),g=a(1940),v=a(6060),E=a(3628);const C=(0,v.c)(g.c)((()=>({margin:"15px 15px",backgroundColor:E.c[500],"&:hover":{backgroundColor:E.c[700]}})));var b=a(7600),w=a(3083),O=a(8604),k=a(8388),S=a(4024),x=a(5466),_=a(9440),j=a(2060),T=(a(5678),a(8900),a(2528));function N(){return N=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},N.apply(this,arguments)}const $=200,I=180,R=["crop","variety","crop_code","category"];function M(e){const{crop:t,variety:a,...n}=e;return{crop_id:t,variety_id:a,...n}}function A(){return n.createElement(w.q,null,n.createElement(O.S,null),n.createElement(k.e,null),n.createElement(S.a,null),n.createElement(x.Wc,null))}function P({field_names:e,fieldValues:t,formData:a,columns:r,cropCategoryOptions:o,cropVarietyOptions:c,handleInputChange:i,showAddModal:l,setShowAddModal:s,setIsSave:d,inputError:v,updateInputError:E,refreshRecord:C,setRefreshRecord:b}){return n.createElement(p.c,{open:l,sx:{display:"flex",justifyContent:"center",alignItems:"center"}},n.createElement(u.c,{sx:{width:400}},n.createElement(m.c,null,n.createElement(h.cp,{container:!0,justifyContent:"center",spacing:2},n.createElement(h.cp,{item:!0,xs:12,sx:{textAlign:"center"}},n.createElement("h1",null,"Add Crop Record")),n.createElement(h.cp,{item:!0,xs:12},n.createElement(f.c,{value:t[e[0]],options:o||[],disableClearable:!0,onChange:(t,a)=>{i(t,a,e[0])},renderInput:t=>n.createElement(y.c,N({},t,{required:!0,variant:"outlined",label:r[1].headerName,error:v[e[0]]}))})),n.createElement(h.cp,{item:!0,xs:12},n.createElement(f.c,{value:t[e[1]],options:c||[],disableClearable:!0,onChange:(t,a)=>{i(t,a,e[1])},renderInput:t=>n.createElement(y.c,N({},t,{required:!0,variant:"outlined",label:r[2].headerName,error:v[e[1]]}))})),n.createElement(h.cp,{item:!0,xs:6},n.createElement(y.c,{value:t[e[2]],InputLabelProps:{shrink:!0,readOnly:!0},variant:"outlined",label:r[3].headerName})),n.createElement(h.cp,{item:!0,xs:6},n.createElement(y.c,{value:t[e[3]],InputLabelProps:{shrink:!0,readOnly:!0},variant:"outlined",label:r[4].headerName})),n.createElement(h.cp,{item:!0,xs:6,sx:{justifyContent:"center",textAlign:"center"}},n.createElement(g.c,{variant:"contained",color:"secondary",onClick:()=>s(!1)},"Cancel")),n.createElement(h.cp,{item:!0,xs:6,sx:{justifyContent:"center",textAlign:"center"}},n.createElement(g.c,{variant:"contained",color:"success",onClick:()=>{Object.values(t).every((e=>""!==e))?async function(){const e=M(a);console.log(e);const t={method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":(0,T.U$)("csrftoken")},body:JSON.stringify(e)};await fetch("/api/crop/create/",t).then((e=>{e.ok&&(d(!0),s(!1),b(~C))}))}():E()}},"Save"))))))}function U(e){e.uid;const t=e.employerID,a=e.privilege,[p,u]=(0,n.useState)([]),[m,h]=(0,n.useState)([]),[g,v]=(0,n.useState)([]),[E,w]=(0,n.useState)({}),[O,k]=(0,n.useState)({}),[S,x]=(0,n.useState)([]),[U,L]=(0,n.useState)([]),[D,V]=(0,n.useState)(!1),[q,z]=(0,n.useState)(!1),[G,F]=(0,n.useState)(!1),[B,H]=(0,n.useState)(!1),[J,X]=(0,n.useState)([]),[W,Y]=(0,n.useState)(null),[K,Q]=(0,n.useState)(null),[Z,ee]=(0,n.useState)(null),[te,ae]=(0,n.useState)(!1);async function ne(e){a.crop_r&&await fetch("/api/crop/list/get/?uid="+e,{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>{e.ok&&e.json().then((e=>{const t=e.data.map((e=>function(e){for(let t in e)null===e[t]&&(e[t]="");return{id:e.cid,crop:e.crop,variety:e.variety,crop_code:e.crop_code,category:e.category,update_time:e.update_time}}(e)));v(t)}))}))}async function re(){await fetch("/api/crop/category/",{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>{e.ok&&e.json().then((e=>{u(e.data)}))}))}async function oe(){await fetch("/api/crop/variety/",{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>{e.ok&&e.json().then((e=>{h(e.data)}))}))}const ce=()=>{X(Object.fromEntries(R.map((e=>[e,!1]))))},ie=()=>{Object.keys(O).forEach((e=>{""===O[e]?X((t=>({...t,[e]:!0}))):X((t=>({...t,[e]:!1})))}))},le=()=>{if(Object.values(O).every((e=>""!==e))){!async function(){const e=M(E);console.log(e);const t={method:"PUT",headers:{"Content-Type":"application/json","X-CSRFToken":(0,T.U$)("csrftoken")},body:JSON.stringify(e)};await fetch("/api/crop/update/",t).then((e=>{e.ok&&(F(!0),Y(null),ae(~te))}))}();const e=g.findIndex((e=>e.id===O.id));v([...g.slice(0,e),O,...g.slice(e+1)])}else ie()},se=e=>{!async function(e){const a={user:t,cid:e};console.log(a);const n={method:"PUT",headers:{"Content-Type":"application/json","X-CSRFToken":(0,T.U$)("csrftoken")},body:JSON.stringify(a)};await fetch("/api/crop/delete/",n).then((e=>{e.ok&&(H(!0),ae(~te))}))}(e.id);const a=g.findIndex((t=>t.id===e.id));v([...g.slice(0,a),...g.slice(a+1)])},de=(e,t,a)=>{a===R[0]?(k({...O,[a]:t.label,[R[1]]:"",[R[2]]:t.crop_code,[R[3]]:t.category}),w({...E,[a]:t.id,[R[1]]:null})):(k({...O,[a]:t.label}),w({...E,[a]:t.id}))},pe=[{field:"operations",headerName:"Operations",sortable:!1,width:150,disableColumnMenu:!0,disableClickEventBubbling:!0,renderCell:e=>W!==e.id?n.createElement(n.Fragment,null,n.createElement(o.c,{onClick:()=>(e=>{const t=S.find((t=>t.label===e.row.crop));w({cid:e.id,crop:t.id}),k(e.row),Y(e.id),ce()})(e),disabled:!a.crop_u},n.createElement(i.c,null)),n.createElement(o.c,{onClick:t=>{Q(t.currentTarget),ee(e.id)},disabled:!a.crop_d},n.createElement(l.c,null)),Z===e.id&&n.createElement(j.c,{anchorEl:K,setAnchorEl:Q,onDeleteClicked:se,params:e,msg:"Delete this record?",type:"delete"})):n.createElement(n.Fragment,null,n.createElement(o.c,{onClick:()=>(Y(null),void ce())},n.createElement(d.c,null)),n.createElement(o.c,{onClick:t=>{Q(t.currentTarget),ee(e.id)}},n.createElement(s.c,null)),Z===e.id&&n.createElement(j.c,{anchorEl:K,setAnchorEl:Q,onSaveClicked:le,params:e,msg:"Update this record?",type:"update"}))},{field:"crop",headerName:"Crop",width:$,renderCell:(e,t=e.id)=>n.createElement(f.c,{options:S||[],disableClearable:!0,readOnly:W!==t,value:W===t?O[R[0]]:e.value,onChange:(e,t)=>{de(0,t,R[0])},renderInput:e=>W!==t?n.createElement(y.c,N({},e,{variant:"standard",InputProps:{disableUnderline:!0},sx:{width:$}})):n.createElement(y.c,N({},e,{variant:"standard",error:J[R[0]],sx:{width:I}}))})},{field:"variety",headerName:"Variety",width:$,renderCell:(e,t=e.id)=>n.createElement(f.c,{options:U||[],disableClearable:!0,readOnly:W!==t,value:W===t?O[R[1]]:e.value,onChange:(e,t)=>{de(0,t,R[1])},renderInput:e=>W!==t?n.createElement(y.c,N({},e,{variant:"standard",InputProps:{disableUnderline:!0},sx:{width:$}})):n.createElement(y.c,N({},e,{variant:"standard",sx:{width:I},error:J[R[1]]}))})},{field:"crop_code",headerName:"Crop Code",width:$,valueGetter:e=>W===e.id?O[R[2]]:e.value},{field:"category",headerName:"Category",width:$,valueGetter:e=>W===e.id?O[R[3]]:e.value},{field:"update_time",headerName:"Update Time",width:$}],ue={field_names:R,fieldValues:O,formData:E,columns:pe,cropCategoryOptions:S,cropVarietyOptions:U,handleInputChange:de,showAddModal:q,setShowAddModal:z,setIsSave:F,inputError:J,updateInputError:ie,refreshRecord:te,setRefreshRecord:ae},me={open:G,setOpen:F,msg:"Crop record is uploaded successfully!",tag:"success"},he={open:B,setOpen:H,msg:"Crop record has been deleted!",tag:"success"};return(0,n.useEffect)((()=>{(async()=>{await Promise.all([re(),oe(),ne(t)])})(),ce(),V(!0)}),[]),(0,n.useEffect)((()=>{x(p.map((e=>({label:e.name,id:e.ccid,crop_code:e.crop_code,category:e.category}))))}),[p]),(0,n.useEffect)((()=>{var e;e=E.crop,L(m.filter((t=>t.crop_id===e)).map((e=>({label:e.name,id:e.cvid}))))}),[E.crop]),(0,n.useEffect)((()=>{D&&ne(t)}),[te]),n.createElement("div",null,n.createElement(C,{variant:"contained",startIcon:n.createElement(c.c,null),onClick:()=>(w({user_id:t}),k(Object.fromEntries(R.map((e=>[e,""])))),Y(null),z(!0),void ce()),disabled:!a.crop_c},"Add Crop"),n.createElement(r.c,{style:{height:900,margin:"0px 15px",width:"calc(100% - 30px)",overflow:"auto"}},n.createElement(_.o,{columns:pe,rows:g,disableRowSelectionOnClick:!0,disableClickEdit:!0,rowSelection:!1,slots:{toolbar:A},localeText:{noRowsLabel:a.crop_r?"No rows":"You don't have the privilege to access this data"}})),n.createElement(P,ue),n.createElement(b.default,me),n.createElement(b.default,he))}},8900:(e,t,a)=>{a.d(t,{o:()=>d});var n=a(1504),r=a.n(n),o=a(420);const c=["Row","Hole Code#","Section","Block"],i=new class{async getSprayData(e,t){const a={method:"GET",headers:{"Content-Type":"application/json"}},n=(await Promise.all([fetch("/api/crop/list/get/?uid="+t,a),fetch("/api/site/list/get/?uid="+t,a),fetch("/api/chemical/list/get/?uid="+t,a),fetch("/api/equipment/list/get/?uid="+t,a),fetch("/api/operation/purchase/list/get/?uid="+t,a),fetch("/api/operation/application/list/get/?uid="+t,a),fetch("/api/crop/category/",a),fetch("/api/operation/application/target/",a),fetch("/api/operation/application/desicisionsupport/",a),fetch("/api/unit/",a),fetch("/api/crop/growthstage/",a),fetch("/workflow/spraycard/assignees/get/?uid="+e+"&employer_id="+t,a)])).map((e=>{if(e.ok)return e.json();throw new Error("Network response was not ok.")})),r=await Promise.all(n),o=e=>{let t=[];for(let a=0;a<e.length;a++){let n={};n={...e[a]},delete n.children,t.push(n),e[a].children&&(t=t.concat(o(e[a].children)))}return t};return{record_data:{cropList:r[0].data,siteList:r[1].data,chemicalList:r[2].data,equipmentList:r[3].data,purchaseList:r[4].data,sprayApplicationList:r[5].data,cropCategory:r[6].data,applicationTarget:r[7].data,decisionSupport:r[8].data,unit:r[9].data,growthStage:r[10].data,assigneeList:r[11].data},option_data:{chemicalOptions:r[4].data.map((e=>{const t=r[2].data.find((t=>t.chemid===e.chemical));return{label:`${t.epa_reg_no} | ${t.trade_name} | $${e.cost_per_unit} per ${t.unit} | ${e.pur_datetime}`,unit:t.unit,cost:e.cost_per_unit,cost_per_unit:`$${e.cost_per_unit} per ${t.unit}`,id:e.prid}})),decisionSupportOptions:r[8].data.map((e=>({label:e.name,id:e.dsid}))),cropOptions:r[0].data.map((e=>({label:`${e.crop} (${e.variety})`,id:e.cid}))),growthStageOptions:r[10].data.map((e=>({label:`${e.name}`,crop_id:e.crop_id,id:e.cgsid}))),targetOptions:r[7].data.map((e=>({label:e.name,id:e.attid}))),siteOptions:o(r[1].data).filter((e=>c.includes(e.type))).map((e=>{let t=e,a=t.name;const n=t.sid,c=t.crop.cid,i=t.crop.ccid,l=`${t.crop.crop} (${t.crop.variety})`,s=t.size,d=t.size_unit;for(;t.parent;)t=o(r[1].data).find((e=>e.sid===t.parent)),a=`${t.name} - ${a}`;return{id:n,label:a,cid:c,ccid:i,crop:l,area:s,unit:d}})),equipmentOptions:r[3].data.map((e=>({label:`${e.name}`,id:e.eid}))),chemicalUnitOptions:r[9].data.filter((e=>"chemical"===e.usage)).map((e=>({label:e.name,id:e.unitid}))),siteUnitOptions:r[9].data.filter((e=>"site"===e.usage)).map((e=>({label:e.name,id:e.unitid}))),assigneeOptions:r[11].data.map((e=>({label:`${e.user} (${e.first_name} ${e.last_name})`,type:e.type,id:e.uid})))}}}constructor(){(0,o.a0)(this)}},l=new class{constructor(){this.sprayCardStore=i}},s=r().createContext(l),d=()=>r().useContext(s)}}]);