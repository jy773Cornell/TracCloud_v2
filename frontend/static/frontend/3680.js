"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[3680],{7600:(e,t,n)=>{n.r(t),n.d(t,{default:()=>i});var c=n(1504),r=n(6988),s=n(6350),a=n(4408);function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var c in n)Object.prototype.hasOwnProperty.call(n,c)&&(e[c]=n[c])}return e},l.apply(this,arguments)}const o=c.forwardRef((function(e,t){return c.createElement(a.c,l({elevation:6,ref:t,variant:"filled"},e))}));function i(e){const t=(t,n)=>{"clickaway"!==n&&e.setOpen(!1)};return c.createElement(r.c,{spacing:2,sx:{width:"100%"}},c.createElement(s.c,{open:e.open,autoHideDuration:6e3,onClose:t},(()=>{switch(e.tag){case"success":return c.createElement(o,{onClose:t,severity:"success",sx:{width:"100%"}},e.msg);case"error":return c.createElement(o,{onClose:t,severity:"error",sx:{width:"100%"}},e.msg);case"warning":return c.createElement(o,{onClose:t,severity:"warning",sx:{width:"100%"}},e.msg);default:return null}})()))}},1300:(e,t,n)=>{n.r(t),n.d(t,{default:()=>C});var c=n(1504),r=n.n(c),s=n(3640),a=n(7729),l=n(2576),o=n(928),i=n(3604),u=n(3328),d=n(1940),m=n(3964),p=n(5984),h=n(6968),f=n(2528),E=n(7600),g=n(3284);const y=(0,c.lazy)((()=>n.e(8336).then(n.bind(n,8336)))),w=(0,c.lazy)((()=>Promise.all([n.e(1109),n.e(7504),n.e(112)]).then(n.bind(n,112))));function C(e){const[t,n]=(0,c.useState)(!1),[C,v]=(0,c.useState)([]),[S,j]=(0,c.useState)(!1),[x,b]=(0,c.useState)(""),[k,O]=(0,c.useState)(!1),[R,F]=(0,c.useState)(!1),[T,P]=(0,c.useState)(!1),W=(0,g.IT)(),U=new URLSearchParams(W.search),I=()=>r().createElement(r().Fragment,null,r().createElement(m.cp,{item:!0,xs:4,sx:{justifyContent:"center",textAlign:"center"}},r().createElement(d.c,{variant:"contained",color:"secondary",onClick:()=>e.setOpenFileWindow(!1)},"Close")),"Client"!==e.relationType&&r().createElement(m.cp,{item:!0,xs:4,sx:{justifyContent:"center",textAlign:"center"}},r().createElement(d.c,{variant:"contained",color:"success",onClick:()=>{C.length>0?j(!0):P(!0)}},"Send Reports"))),_={...e,refreshRecord:t,setRefreshRecord:n,selectedFiles:C,setSelectedFiles:v},z={...e,refreshRecord:t,setRefreshRecord:n};(0,c.useEffect)((()=>{U.get("mid")&&U.get("reportHistory")&&(e.setOpenFileWindow(!0),async function(t){await fetch("/message/get?mid="+t,{method:"GET",headers:{"Content-Type":"application/json"}}).then((t=>{t.ok&&t.json().then((t=>{e.setSelectedUser(t.data.author)}))}))}(U.get("mid")))}),[]),(0,c.useEffect)((()=>{b(""),O(!1)}),[S]),(0,c.useEffect)((()=>{v([])}),[e.openFileWindow]);const A={open:R,setOpen:F,msg:"Selected reports have been sent!",tag:"success"},D={open:T,setOpen:P,msg:"Please select at least one report to send!",tag:"warning"};return r().createElement("div",null,r().createElement(p.c,{open:e.openFileWindow,sx:{display:"flex",justifyContent:"center",alignItems:"center"}},"Client"===e.relationType?r().createElement(h.c,{style:{height:"calc(3/4 * 100vh)",width:"calc(4/5 * 2/3 * 100vw)"}},r().createElement(m.cp,{container:!0,justifyContent:"center",spacing:2},r().createElement(m.cp,{item:!0,xs:12},r().createElement(w,z)),I())):r().createElement(h.c,{style:{height:"calc(3/4 * 100vh)",width:"calc(4/5 * 100vw)"}},r().createElement(m.cp,{container:!0,justifyContent:"center",spacing:2},r().createElement(m.cp,{item:!0,xs:8},r().createElement(y,_)),r().createElement(m.cp,{item:!0,xs:4},r().createElement(w,z)),I(),r().createElement(s.c,{open:S},r().createElement(a.c,null,"Subject"),r().createElement(l.c,null,r().createElement(o.c,null,"Please input the subject for the reports sharing."),r().createElement(i.c,{autoFocus:!0,margin:"dense",id:"subject",fullWidth:!0,variant:"standard",error:k,onChange:e=>{b(e.target.value)}})),r().createElement(u.c,null,r().createElement(d.c,{onClick:()=>j(!1)},"Cancel"),r().createElement(d.c,{onClick:()=>{""===x?O(!0):async function(e,c,r,s){const a={author_id:e,recipient_id:c,selected_reports:r,subject:s};console.log(a);const l={method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":(0,f.U$)("csrftoken")},body:JSON.stringify(a)};await fetch("/media/reports/send/",l).then((e=>{e.ok&&(F(!0),j(!1),v([]),n(~t))}))}(e.employerID,e.selectedUser,C,x)}},"Send")))))),r().createElement(E.default,A),r().createElement(E.default,D))}}}]);