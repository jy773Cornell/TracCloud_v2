"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[7032],{2060:(e,t,a)=>{a.d(t,{c:()=>d});var n=a(1504),r=a(1940),l=a(6864),c=a(8857),i=a(6968);function d(e){return n.createElement(l.cp,{open:Boolean(e.anchorEl),anchorEl:e.anchorEl,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},n.createElement(i.c,{sx:{p:1,maxWidth:400}},n.createElement(c.c,{variant:"body1"},e.msg),n.createElement(r.c,{onClick:()=>{"delete"===e.type?(e.setAnchorEl(null),e.onDeleteClicked(e.params)):"update"===e.type&&(e.setAnchorEl(null),e.onSaveClicked())},color:"primary"},"Yes"),n.createElement(r.c,{onClick:()=>e.setAnchorEl(null),color:"secondary"},"No")))}},7600:(e,t,a)=>{a.r(t),a.d(t,{default:()=>o});var n=a(1504),r=a(6988),l=a(6350),c=a(4408);function i(){return i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},i.apply(this,arguments)}const d=n.forwardRef((function(e,t){return n.createElement(c.c,i({elevation:6,ref:t,variant:"filled"},e))}));function o(e){const t=(t,a)=>{"clickaway"!==a&&e.setOpen(!1)};return n.createElement(r.c,{spacing:2,sx:{width:"100%"}},n.createElement(l.c,{open:e.open,autoHideDuration:6e3,onClose:t},(()=>{switch(e.tag){case"success":return n.createElement(d,{onClose:t,severity:"success",sx:{width:"100%"}},e.msg);case"error":return n.createElement(d,{onClose:t,severity:"error",sx:{width:"100%"}},e.msg);case"warning":return n.createElement(d,{onClose:t,severity:"warning",sx:{width:"100%"}},e.msg);default:return null}})()))}},7032:(e,t,a)=>{a.r(t),a.d(t,{default:()=>L});var n=a(1504),r=a(6968),l=a(3562),c=a(3704),i=a(3683),d=a(9700),o=a(108),s=a(8880),u=a(5984),m=a(7516),p=a(4477),h=a(3964),E=a(3604),v=a(4660),f=a(3184),g=a(1940),b=a(6060),y=a(3628);const C=(0,b.c)(g.c)((()=>({margin:"15px 15px",backgroundColor:y.c[500],"&:hover":{backgroundColor:y.c[700]}})));var _=a(7600),w=a(3083),x=a(8604),k=a(8388),O=a(4024),N=a(5466),I=a(9440),S=a(2060),P=(a(2264),a(2528));function j(){return j=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},j.apply(this,arguments)}const A=200,T=180,R=["trade_name","epa_reg_no","unit","restricted_use","active_ingredient","percent_ai","rei","phi","type","company","labeled_crops","label_image"];function U(e){const{unit:t,...a}=e;return{unit_id:t,...a}}function W(){return n.createElement(w.q,null,n.createElement(x.S,null),n.createElement(k.e,null),n.createElement(O.a,null),n.createElement(N.Wc,null))}function G({fieldValues:e,formData:t,columns:a,unitOptions:r,chemicalProductBaseOptions:l,handleInputChange:c,handleEPANOChange:i,showAddModal:d,setShowAddModal:o,setIsSave:s,inputError:b,updateInputError:y,refreshRecord:C,setRefreshRecord:_}){return n.createElement(u.c,{open:d,sx:{display:"flex",justifyContent:"center",alignItems:"center"}},n.createElement(m.c,{sx:{width:1e3}},n.createElement(p.c,null,n.createElement(h.cp,{container:!0,justifyContent:"center",spacing:2},n.createElement(h.cp,{item:!0,xs:12,sx:{textAlign:"center"}},n.createElement("h1",null,"Add Chemical Record")),n.createElement(h.cp,{item:!0,xs:4},n.createElement(E.c,{value:e[R[0]],fullWidth:!0,InputLabelProps:{shrink:!0,readOnly:!0},variant:"outlined",label:a[1].headerName})),n.createElement(h.cp,{item:!0,xs:4},n.createElement(v.c,{value:e[R[1]],options:l,onChange:(e,t)=>{c(e,t,R[1])},renderInput:e=>n.createElement(E.c,j({},e,{required:!0,variant:"outlined",fullWidth:!0,label:a[2].headerName,error:b[R[1]],onChange:e=>{i(e)}}))})),n.createElement(h.cp,{item:!0,xs:4},n.createElement(v.c,{value:e[R[2]],options:r,onChange:(e,t)=>{c(e,t,R[2])},renderInput:e=>n.createElement(E.c,j({},e,{required:!0,variant:"outlined",fullWidth:!0,label:a[3].headerName,error:b[R[2]]}))})),n.createElement(h.cp,{item:!0,xs:4},n.createElement(E.c,{value:e[R[3]],InputLabelProps:{shrink:!0,readOnly:!0},variant:"outlined",fullWidth:!0,label:a[4].headerName})),n.createElement(h.cp,{item:!0,xs:4},n.createElement(E.c,{value:e[R[4]],InputLabelProps:{shrink:!0,readOnly:!0},variant:"outlined",fullWidth:!0,label:a[5].headerName})),n.createElement(h.cp,{item:!0,xs:4},n.createElement(E.c,{value:e[R[5]],InputLabelProps:{shrink:!0,readOnly:!0},variant:"outlined",fullWidth:!0,label:a[6].headerName})),n.createElement(h.cp,{item:!0,xs:4},n.createElement(E.c,{error:b[R[6]],required:!0,variant:"outlined",fullWidth:!0,type:"number",inputProps:{step:.1},InputProps:{endAdornment:n.createElement(f.c,{position:"end"},"hours")},label:a[7].headerName,onChange:e=>{c(e,e.target.value,R[6])}})),n.createElement(h.cp,{item:!0,xs:4},n.createElement(E.c,{error:b[R[7]],required:!0,variant:"outlined",fullWidth:!0,type:"number",inputProps:{step:.1},InputProps:{endAdornment:n.createElement(f.c,{position:"end"},"days")},label:a[8].headerName,onChange:e=>{c(e,e.target.value,R[7])}})),n.createElement(h.cp,{item:!0,xs:4},n.createElement(E.c,{value:e[R[8]],InputLabelProps:{shrink:!0,readOnly:!0},variant:"outlined",fullWidth:!0,label:a[9].headerName})),n.createElement(h.cp,{item:!0,xs:4},n.createElement(E.c,{value:e[R[9]],InputLabelProps:{shrink:!0,readOnly:!0},variant:"outlined",fullWidth:!0,label:a[10].headerName})),n.createElement(h.cp,{item:!0,xs:4},n.createElement(E.c,{variant:"outlined",fullWidth:!0,label:a[11].headerName,onChange:e=>{c(e,e.target.value,R[10])}})),n.createElement(h.cp,{item:!0,xs:4},n.createElement(E.c,{variant:"outlined",fullWidth:!0,label:a[12].headerName,onChange:e=>{c(e,e.target.value,R[11])}})),n.createElement(h.cp,{item:!0,xs:6,sx:{justifyContent:"center",textAlign:"center"}},n.createElement(g.c,{variant:"contained",color:"secondary",onClick:()=>o(!1)},"Cancel")),n.createElement(h.cp,{item:!0,xs:6,sx:{justifyContent:"center",textAlign:"center"}},n.createElement(g.c,{variant:"contained",color:"success",onClick:()=>{0===Object.keys(e).filter((e=>R.slice(0,10).includes(e))).filter((t=>""===e[t])).length?async function(){const e=U(t);console.log(e);const a={method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":(0,P.U$)("csrftoken")},body:JSON.stringify(e)};await fetch("/api/chemical/create/",a).then((e=>{e.ok&&(s(!0),o(!1),_(~C))}))}():y()}},"Save"))))))}function L(e){e.uid;const t=e.employerID,a=e.privilege,[u,m]=(0,n.useState)([]),[p,h]=(0,n.useState)([]),[f,g]=(0,n.useState)([]),[b,y]=(0,n.useState)({}),[w,x]=(0,n.useState)({}),[k,O]=(0,n.useState)([]),[N,L]=(0,n.useState)([]),[D,q]=(0,n.useState)(!1),[F,M]=(0,n.useState)(!1),[B,H]=(0,n.useState)(!1),[J,X]=(0,n.useState)(!1),[$,z]=(0,n.useState)([]),[V,Y]=(0,n.useState)(null),[K,Q]=(0,n.useState)(null),[Z,ee]=(0,n.useState)(null),[te,ae]=(0,n.useState)(!1);async function ne(e){a.chem_r&&await fetch("/api/chemical/list/get/?uid="+e,{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>{e.ok&&e.json().then((e=>{const t=e.data.map((e=>function(e){for(let t in e)null===e[t]&&(e[t]="");return{id:e.chemid,trade_name:e.trade_name,epa_reg_no:e.epa_reg_no,unit:e.unit,restricted_use:e.restricted_use,active_ingredient:e.active_ingredient,percent_ai:e.percent_ai,rei:e.rei,phi:e.phi,type:e.type,company:e.company,labeled_crops:e.labeled_crops,label_image:e.label_image,update_time:e.update_time}}(e)));g(t)}))}))}async function re(){await fetch("/api/unit/?usage=chemical",{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>{e.ok&&e.json().then((e=>{m(e.data)}))}))}const le=()=>{z(Object.fromEntries(R.map((e=>[e,!1]))))},ce=()=>{Object.keys(w).forEach((e=>{""===w[e]?z((t=>({...t,[e]:!0}))):z((t=>({...t,[e]:!1})))}))},ie=()=>{if(Object.values(w).slice(0,10).every((e=>""!==e))){!async function(){const e=U(b);console.log(e);const t={method:"PUT",headers:{"Content-Type":"application/json","X-CSRFToken":(0,P.U$)("csrftoken")},body:JSON.stringify(e)};await fetch("/api/chemical/update/",t).then((e=>{e.ok&&(H(!0),Y(null),ae(~te))}))}();const e=f.findIndex((e=>e.id===w.id));g([...f.slice(0,e),w,...f.slice(e+1)])}else ce()},de=e=>{!async function(e){const a={user:t,chemid:e};console.log(a);const n={method:"PUT",headers:{"Content-Type":"application/json","X-CSRFToken":(0,P.U$)("csrftoken")},body:JSON.stringify(a)};await fetch("/api/chemical/delete/",n).then((e=>{e.ok&&(X(!0),ae(~te))}))}(e.id);const a=f.findIndex((t=>t.id===e.id));g([...f.slice(0,a),...f.slice(a+1)])},oe=(e,t,a)=>{a===R[1]?(x({...w,[a]:t.label,[R[0]]:t.product_name_dec,[R[3]]:t.restricted_use_dec,[R[4]]:t.pc_name_dec,[R[5]]:t.pc_pt_dec,[R[8]]:t.product_type_dec,[R[9]]:t.company_name_dec}),y({...b,[a]:t.label,[R[0]]:t.product_name_dec,[R[3]]:t.restricted_use_dec,[R[4]]:t.pc_name_dec,[R[5]]:t.pc_pt_dec,[R[8]]:t.product_type_dec,[R[9]]:t.company_name_dec})):a===R[2]?(x({...w,[a]:t.label}),y({...b,[a]:t.id})):(x({...w,[a]:t}),y({...b,[a]:t}))},se=e=>{e.target.value.length>=4&&async function(e){await fetch("/api/chemical/productbase/?reg_no="+e,{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>{e.ok&&e.json().then((e=>{h(e.data)}))}))}(e.target.value)},ue=[{field:"operations",headerName:"Operations",sortable:!1,width:150,disableColumnMenu:!0,disableClickEventBubbling:!0,renderCell:e=>V!==e.id?n.createElement(n.Fragment,null,n.createElement(l.c,{onClick:()=>(e=>{const t=k.find((t=>t.label===e.row.unit));y({chemid:e.id,unit:t.id}),x(e.row),Y(e.id),le()})(e),disabled:!a.chem_u},n.createElement(i.c,null)),n.createElement(l.c,{onClick:t=>{Q(t.currentTarget),ee(e.id)},disabled:!a.chem_d},n.createElement(d.c,null)),Z===e.id&&n.createElement(S.c,{anchorEl:K,setAnchorEl:Q,onDeleteClicked:de,params:e,msg:"Delete this record?",type:"delete"})):n.createElement(n.Fragment,null,n.createElement(l.c,{onClick:()=>(Y(null),void le())},n.createElement(s.c,null)),n.createElement(l.c,{onClick:t=>{Q(t.currentTarget),ee(e.id)}},n.createElement(o.c,null)),Z===e.id&&n.createElement(S.c,{anchorEl:K,setAnchorEl:Q,onSaveClicked:ie,params:e,msg:"Update this record?",type:"update"}))},{field:"trade_name",headerName:"Trade Name",width:A,valueGetter:e=>V===e.id?w[R[0]]:e.value},{field:"epa_reg_no",headerName:"EPA REG NO.",width:A,renderCell:(e,t=e.id)=>n.createElement(v.c,{options:N,disableClearable:!0,readOnly:V!==t,value:V===t?w[R[1]]:e.value,onChange:(e,t)=>{oe(0,t,R[1])},renderInput:e=>V!==t?n.createElement(E.c,j({},e,{variant:"standard",InputProps:{disableUnderline:!0},sx:{width:A}})):n.createElement(E.c,j({},e,{variant:"standard",error:$[R[1]],sx:{width:T},onChange:e=>{se(e)}}))})},{field:"unit",headerName:"Applied Unit",width:A,renderCell:(e,t=e.id)=>n.createElement(v.c,{options:k,disableClearable:!0,readOnly:V!==t,value:V===t?w[R[2]]:e.value,onChange:(e,t)=>{oe(0,t,R[2])},renderInput:e=>V!==t?n.createElement(E.c,j({},e,{variant:"standard",InputProps:{disableUnderline:!0},sx:{width:A}})):n.createElement(E.c,j({},e,{variant:"standard",error:$[R[2]],sx:{width:T}}))})},{field:"restricted_use",headerName:"Restricted Use",width:A,valueGetter:e=>V===e.id?w[R[3]]:e.value},{field:"active_ingredient",headerName:"Active Ingredient",width:A,valueGetter:e=>V===e.id?w[R[4]]:e.value},{field:"percent_ai",headerName:"% A.I.",width:A,valueGetter:e=>V===e.id?w[R[5]]:e.value},{field:"rei",headerName:"REI-Hrs",width:A,renderCell:(e,t=e.id)=>V!==t?n.createElement(E.c,{variant:"standard",value:e.value,InputProps:{disableUnderline:!0,readOnly:!0},sx:{width:A}}):n.createElement(E.c,{variant:"standard",value:w[R[6]],error:$[R[6]],sx:{width:T},onChange:e=>{oe(0,e.target.value,R[6])}})},{field:"phi",headerName:"PHI-Days",width:A,renderCell:(e,t=e.id)=>V!==t?n.createElement(E.c,{variant:"standard",value:e.value,InputProps:{disableUnderline:!0,readOnly:!0},sx:{width:A}}):n.createElement(E.c,{variant:"standard",value:w[R[7]],error:$[R[7]],sx:{width:T},onChange:e=>{oe(0,e.target.value,R[7])}})},{field:"type",headerName:"Product Type",width:A,valueGetter:e=>V===e.id?w[R[8]]:e.value},{field:"company",headerName:"Company",width:A,valueGetter:e=>V===e.id?w[R[9]]:e.value},{field:"labeled_crops",headerName:"Labeled Crops",width:A,renderCell:(e,t=e.id)=>V!==t?n.createElement(E.c,{variant:"standard",value:e.value,InputProps:{disableUnderline:!0,readOnly:!0},sx:{width:A}}):n.createElement(E.c,{variant:"standard",value:w[R[10]],sx:{width:T},onChange:e=>{oe(0,e.target.value,R[10])}})},{field:"label_image",headerName:"Labeled Image",sortable:!1,width:A,renderCell:(e,t=e.id)=>V!==t?n.createElement(E.c,{variant:"standard",value:e.value,InputProps:{disableUnderline:!0,readOnly:!0},sx:{width:A}}):n.createElement(E.c,{variant:"standard",value:w[R[11]],sx:{width:T},onChange:e=>{oe(0,e.target.value,R[11])}})},{field:"update_time",headerName:"Update Time",sortable:!1,width:A}],me={fieldValues:w,formData:b,columns:ue,unitOptions:k,chemicalProductBaseOptions:N,handleInputChange:oe,handleEPANOChange:se,showAddModal:F,setShowAddModal:M,setIsSave:H,inputError:$,updateInputError:ce,refreshRecord:te,setRefreshRecord:ae},pe={open:B,setOpen:H,msg:"Chemical record is uploaded successfully!",tag:"success"},he={open:J,setOpen:X,msg:"Chemical record has been deleted!",tag:"success"};return(0,n.useEffect)((()=>{(async()=>{await Promise.all([re(),ne(t)])})(),le(),q(!0)}),[]),(0,n.useEffect)((()=>{O(u.map((e=>({label:e.name,id:e.unitid}))))}),[u]),(0,n.useEffect)((()=>{L(p.map((e=>({label:e.epa_reg_no_dec,id:e.chempbid,...e}))))}),[p]),(0,n.useEffect)((()=>{D&&ne(t)}),[te]),n.createElement("div",null,n.createElement(C,{variant:"contained",startIcon:n.createElement(c.c,null),onClick:()=>(y({user_id:t}),x(Object.fromEntries(R.map((e=>[e,""])))),Y(null),M(!0),void le()),disabled:!a.chem_c},"Add Chemical"),n.createElement(r.c,{style:{height:900,margin:"0px 15px",width:"calc(100% - 30px)",overflow:"auto"}},n.createElement(I.o,{columns:ue,rows:f,disableRowSelectionOnClick:!0,disableClickEdit:!0,rowSelection:!1,slots:{toolbar:W},localeText:{noRowsLabel:a.chem_r?"No rows":"You don't have the privilege to access this data"}})),n.createElement(G,me),n.createElement(_.default,pe),n.createElement(_.default,he))}}}]);